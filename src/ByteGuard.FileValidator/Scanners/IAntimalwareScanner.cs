namespace ByteGuard.FileValidator.Scanners;

/// <summary>
/// An abstraction for antimalware scanners.
/// </summary>
/// <typeparam name="TOptions">
/// The type of options used to configure the antimalware scanner.
/// Implementers should ensure that a constructor with the type exists.
/// </typeparam>
public interface IAntimalwareScanner<TOptions>
{
    /// <summary>
    /// Whether the given file is clean from malicious content based on an antimalware scanner.
    /// </summary>
    /// <remarks>
    /// Implementers should let exception propagate in case the antimalware scanner is not reachable or any other error occurs.
    /// The <see cref="FileValidator"/> will catch those exceptions and handle them appropriately.
    /// </remarks>
    /// <param name="contentStream">Stream content of the file.</param>
    /// <param name="fileName">ile name including extension (e.g. <c>my-file.jpg</c>).</param>
    /// <returns><c>true</c> if the antimalware scanner did not find anything, <c>false</c> otherwise.</returns>
    public bool IsClean(Stream contentStream, string fileName);
}
